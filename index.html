<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surfdog - The Loyal Surf Report</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts: Poppins for headings -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --dog-blue: #007AFF; /* Bright Electric Blue */
            --dog-sky: #E0F2FE;
            --dog-text: #1e3a8a;
        }

        body {
            background-color: #FAFAFA;
            font-family: 'Segoe UI', system-ui, sans-serif;
            color: #334155;
            min-height: 100vh;
            /* Prevent body scroll on desktop to enforce the frame feel */
            @media (min-width: 768px) {
                overflow: hidden;
            }
        }

        h1, h2, h3, .brand-font {
            font-family: 'Poppins', sans-serif;
        }

        /* --- Background Pattern --- */
        .watercolor-bg {
            background-color: #ffffff;
            background-image: radial-gradient(#E2E8F0 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* --- Cards --- */
        .dog-card {
            background: white;
            border-radius: 24px;
            box-shadow: 
                0 4px 6px -1px rgba(0, 0, 0, 0.02), 
                0 10px 15px -3px rgba(0, 122, 255, 0.08);
            border: 1px solid rgba(226, 232, 240, 0.8);
            transition: transform 0.2s ease, box-shadow 0.2s;
            overflow: hidden; 
        }

        .dog-card:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 10px 25px -5px rgba(0, 122, 255, 0.15), 
                0 8px 10px -6px rgba(0, 122, 255, 0.1);
        }

        /* --- UI Elements --- */
        .dog-btn {
            background: white;
            border: 1px solid #E2E8F0;
            color: #475569;
            transition: all 0.2s;
        }
        .dog-btn:hover {
            border-color: var(--dog-blue);
            color: var(--dog-blue);
            background: #F0F9FF;
        }
        .dog-btn.active {
            background: var(--dog-blue);
            color: white;
            border-color: var(--dog-blue);
            box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);
        }

        .dog-input {
            background: #F8FAFC;
            border: 2px solid #E2E8F0;
            color: #334155;
            transition: all 0.2s;
        }
        .dog-input:focus {
            background: white;
            border-color: var(--dog-blue);
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }
        
        /* New Settings Toggle Styles */
        .toggle-group {
            display: flex;
            background: #F1F5F9;
            padding: 4px;
            border-radius: 16px;
            gap: 4px;
        }
        
        .toggle-option {
            flex: 1;
            padding: 16px 8px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            border: 2px solid transparent;
            color: #64748B;
        }

        .toggle-option:hover:not(.selected) {
            background: rgba(255, 255, 255, 0.5);
            color: #334155;
        }

        .toggle-option.selected {
            background: white;
            border-color: var(--dog-blue);
            color: var(--dog-blue);
            box-shadow: 0 4px 12px rgba(0, 122, 255, 0.15);
            transform: scale(1.02); /* Pop effect */
        }

        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94A3B8; }

        .spinner {
            border: 3px solid rgba(0, 122, 255, 0.1);
            border-left-color: var(--dog-blue);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        .compass-arrow { transition: transform 1s cubic-bezier(0.4, 0, 0.2, 1); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">

        // --- ICONS & LOGO ---
        const Icons = {
            Logo: () => (
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 959.16 958.88" className="w-12 h-12">
        <path fill="#007AFF" d="M771.22,858.8c-57.18,43.87-123.39,75.29-194.38,90.06-186.6,38.82-375.8-37.29-486.69-191.45C31.99,676.53,0,578.7,0,478.64c0-31.97,3.32-61.79,9.63-93.28,12.73-63.61,38.65-122.97,75.31-176.61,37.67-55.11,86.88-101.35,143.26-137.03C297.78,27.7,377.81,3.87,459.73.43c127.46-5.36,249.73,39.48,343.08,125.96,74.48,69,126.99,159.43,146.86,259.5,12.09,60.86,13.09,125,.3,185.85-7.27,34.59-17.31,67.68-31.75,100.1-32.7,73.43-83.17,137.99-147.01,186.97ZM644.82,183.1c9.18,6.2,17.66,9.26,28.01,10.4,31.08,3.41,57.85,19.32,76.14,44.55,17.38,23.97,29.73,48.46,47.82,73.22,19.92,27.27,45.92,48.39,64.34,73.47,23.22,31.61,14.27,70.56.61,104.68-9.47,23.65-22.82,44.42-38.91,64.08-5.99,7.32-11.47,14.34-16.6,22.13-10.36,15.74-1.51,30.13-4.96,52.93-1.6,10.57-6.5,20.28-15.4,25.71-11.41,6.96-24.48,5.96-37.82-.44-.92,26.55,6.42,51.94,17.37,75.7,12.27,26.64,19.55,43.81,26.64,72.31,11.65-10.78,21.04-21.45,30.9-33.04,54.12-63.57,88.91-139.54,101.94-222.36,19.68-125.06-17.18-254.14-97.35-351.69C743.24,92.1,621.29,30.88,487.77,28.71c-90.48-1.47-178.67,23.9-253.96,73.86-50.41,33.45-93.29,75.71-127.15,125.82-60.71,89.85-88.08,199.18-73.9,307.01,12.27,93.31,53.17,179.78,116.91,248.41,6.16,6.63,11.46,12.5,18.18,18.06,11.35-55.99,45.4-89.87,44.22-147.75-10.89,4.53-21.67,6.85-32.46,2.8-11.57-4.34-18.97-14.9-21-27.31-3.76-23.02,5.21-37.82-5.02-53.81-5.39-8.43-11.21-15.91-17.71-23.71-25.28-30.34-42.96-65.77-50.22-104.61-8.26-44.17,13.01-64.77,39.92-93.81,12.17-13.13,24.35-25.38,35.25-39.67,21.76-28.51,38.02-64.5,60.56-88.4,17.17-18.22,39.84-29.08,64.78-31.8,10.45-1.14,18.79-4.46,27.55-10.36,36.92-24.85,78.43-40.33,122.94-45.18,28.61-3.12,56.14-3.2,84.78-.28,44.48,4.54,86.12,19.94,123.38,45.12ZM557,454.07c4.43,21-2.96,43.76-17.08,59.6-13.04,14.62-29.68,22-47.87,28.51l.66,23.34,28.18,18.07c9.96,6.38,20.81,11.49,32.71,12.95,17.07,2.09,33.43-4.31,45.62-16.46,7.2-7.17,13.77-15.45,18.49-24.5l12.38-23.74c-2.08-3.22-14.24-9.85-7.39-16.58,4.37-4.29,11.91-3.89,17.56-1.52,22.78,9.56,26.9,37.58,18.28,41.02-1.33.53-5-.15-6.19-1.11l-6.99-5.62c-18.26,37.48-19.21,63.35-39.66,101.54-7.64,14.27-17.62,26.41-30.5,36.27l-2.54,20.05c-.98,7.75,26.53-14.37,34.72-27.68l22.27-36.17c18.63-30.25,38.41-47.34,51.16-80.53,4.4-11.47,4.98-22.21,3.91-34.3-2.15-24.35-.45-48.2,1.56-72.73,4.56-55.76,7.34-94.9-9.55-149.08-2.55-8.17-10.16-27.7-2.7-30.67,10.5-4.18,25.28,25.94,28.9,34.53,9.55,22.7,13.23,46.5,13.89,71.38.78,29.48-1.33,57.63-3.73,87.03-3.8,46.53-2.55,105.02,27.4,142.93,6.01,7.6,20.22,22.69,29.39,20.22,6.56-1.76,4.5-24.15,4.02-30.12-1.55-19.36-2.06-38.19,0-57.43.74-6.87,5.58-38.06,15.47-34.11,7.58,3.03,2.45,24.39,5.41,34.7,29.01-33.61,49.08-70.47,52.89-113.65,1.21-13.74-5.7-26.86-14.69-36.5l-37.4-40.13c-18.05-19.37-32.45-40.35-46.08-62.98-20.26-33.63-37.4-64.22-79.48-69.24-16.21-1.93-30.01-7.81-43.57-16.73-25.64-16.86-52.74-28.45-83.12-34.44-42.19-8.31-84.66-8.47-126.87,0-30.13,6.05-57.7,17.22-83,34.36-13.42,9.09-26.52,14.56-42.73,16.66-16.43,2.13-32.37,8.07-44.46,19.52-7.56,7.16-14.36,15.05-19.8,23.82l-20.87,33.6c-14.78,23.79-31.04,45.26-50.68,65.35-11.99,12.26-23.7,24.05-33.82,37.6-8.36,11.19-10.64,23.96-8.45,37.48,6.54,40.39,24.71,73.27,52.34,104.89l1.48-29.07c.11-2.13,3.12-5.48,4.9-5.49,6.58,0,10.1,12.12,11.44,18.15,5.24,23.59,5.38,47.03,3.16,71.03-.6,6.54-2.84,30.68,3.99,32.68,8.82,2.58,23.48-12.75,29.38-20.35,28.57-36.8,31.21-92.8,27.57-137.81-2.42-29.89-4.32-58.39-4.12-88.28.17-25.27,3.59-49.49,12.84-72.7,3.56-8.92,19.09-41.69,30.07-36.84,7.9,3.49-.27,23.01-3.21,32.26-26.76,84.26-1.94,145.13-7.73,221.16-.77,10.09-.4,19.36,2.66,28.93,5.57,17.39,14.39,32.4,25.64,46.77,13.64,17.42,25.52,35.06,36.58,54.15,12.2,21.07,24.78,39.59,47.81,50.46l-2.88-22.46c-45.73-36.18-46.85-90.24-70.29-138.38l-6.22,5.67c-1.21,1.11-5.09,1.86-6.59,1.16s-3.84-3.8-4.04-5.53c-2.2-18.8,16.02-40.04,34.06-36.53,3.77.73,7.15,3.48,7.42,6.74.92,11-11.89,5.68-7.18,16.33,7.42,16.77,16.04,31.84,28.92,44.64,17.35,17.24,41.93,21.45,64.18,10.81,11.71-5.6,22.32-12.53,33.22-19.76l8.81-5.85.13-23.41c-33.16-11.55-57.97-29.04-65.09-64.74-3.6-18.03,1.41-36.02,16.72-47.42,35.23-26.24,128.59-22.35,138.4,24.24ZM512.59,451.91c3.15-.78,5.62-2.51,7.75-4.49-11.57-14.64-69.12-14.58-81.25-.33,1.23,1.44,3.73,3.61,5.1,3.97,22.51,5.96,45.18,6.6,68.4.85ZM668.46,633.35c-8.82,11.35-16.02,22.33-22.89,34.45-18.3,33.36-40.24,59.81-77.15,72.72-5.22,1.82-9.91,4.75-13.06,9.08-18.68,25.7-47.93,38.27-79.46,37.17-30.9-1.07-58.14-16.07-74.75-42.3l-21.6-9.03c-31.89-13.34-51.93-43.9-68.19-72.19-15.46-26.9-33.74-44.84-49.15-72.73-5.95,15.24-12.99,27.42-22.8,39.56,1.93,29.43-1.36,58.18-9.61,86.52-13.88,38.46-33.28,65.82-37.58,107.79,150.7,126.26,360.89,140.37,526.49,35.46,17.31-11.55,33.43-22.84,49.16-35.87-3.66-27.1-12.9-50.06-24.04-73.99-18.49-37.61-26.47-77.92-23.33-119.69-9.97-12.44-17.44-24.93-23.01-39.95-9.07,15.51-17.98,29.22-29.03,43ZM491.02,634.44c-4.69,8.12-.52,62.79-10.32,63.25-12.64.59-6.34-57.89-13.25-63.93-12.35-10.8-28.77-11.32-43.48-6.12-4.54,1.61-10.56,3.8-13.46,7.11l-1.09,26.53c-.66,15.99-.58,31.36,3.8,46.67,5.09,17.77,14.97,33.18,31.12,42.73,19.34,11.43,43.2,12.94,63.84,3.67s33.59-27.24,38.84-48.29c3.08-12.36,3.99-24.67,3.45-37.47l-1.4-33.7c-16.05-12.56-41.44-15.13-58.07-.45Z"/>
        <path fill="#007AFF" d="M639.2,369.49c-13.95,9.05-18.56-12.42-34.19-21.03-16.32-9-25.49,3.25-33.63,12.98-3.18,3.8-8.43,5.17-12.82,3.35-3.56-1.47-7.18-7-6.27-12.17,3.62-20.67,22.61-37.37,44.45-35.97,36.07,2.31,55.04,44.68,42.46,52.84Z"/>
        <path fill="#007AFF" d="M353.12,349.37c-14.79,10.22-17.23,25.28-30.42,20.91-15.74-5.21-.87-36.75,22.17-48.69,12.83-6.65,27.46-7,40.65.29,19.33,10.68,28.45,37.25,15.89,42.98-3.91,1.78-9.31.87-12.4-2.74l-7.87-9.18c-6.93-8.08-18.78-9.95-28.03-3.56Z"/>
    </svg>
),
            Waves: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/><path d="M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/><path d="M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/></svg>,
            Wind: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2"/><path d="M9.6 4.6A2 2 0 1 1 11 8H2"/><path d="M12.6 19.4A2 2 0 1 0 14 16H2"/></svg>,
            Clock: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
            MapPin: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>,
            Navigation: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="3 11 22 2 13 21 11 13 3 11"/></svg>,
            Droplets: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.8-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z"/><path d="M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97"/></svg>,
            Thermometer: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/></svg>,
            Search: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>,
            X: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>,
            Star: ({ fill = "none", className }) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            Gear: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>,
            Board: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="9" y="2" width="6" height="20" rx="3"></rect><path d="M12 4v2"></path></svg>,
            Sun: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>,
            // New Settings Icons
            LifeBuoy: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="4"/><line x1="4.93" y1="4.93" x2="9.17" y2="9.17"/><line x1="14.83" y1="14.83" x2="19.07" y2="19.07"/><line x1="14.83" y1="9.17" x2="19.07" y2="4.93"/><line x1="14.83" y1="9.17" x2="18.36" y2="5.64"/><line x1="4.93" y1="19.07" x2="9.17" y2="14.83"/></svg>,
            Rocket: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/><path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/></svg>,
            Lightning: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
            Target: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
            Tree: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 2L4 14h6v8h4v-8h6z"/></svg>,
            Paw: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 17c-2.76 0-5 2.24-5 5h10c0-2.76-2.24-5-5-5z"/><circle cx="5" cy="13" r="3"/><circle cx="12" cy="9" r="3"/><circle cx="19" cy="13" r="3"/></svg>,
            Fin: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 17a5 5 0 0 1-5 5H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h1.5a1.5 1.5 0 0 1 1.5 1.5V17"/><path d="M7 17c5 0 8.5-4.5 11-13"/></svg>,
            Crown: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></svg>
        };

        // --- DATA ---
        // Facing is the compass direction the beach faces (approx degrees)
        const LOCAL_SPOTS = [
            { id: 'omaha', name: 'Omaha Beach, NZ', lat: -36.3260, lon: 174.7804, description: "Clear waters, white sand. Best on N/NE swells.", difficulty: "Beginner", facing: 80 },
            { id: 'piha', name: 'Piha Beach, NZ', lat: -36.9547, lon: 174.4694, description: "Famous black sand surf. Strong currents.", difficulty: "Expert", facing: 260 },
        ];

        const FAMOUS_SPOTS = [
            { id: 'pipeline', name: 'Pipeline, Hawaii', lat: 21.6640, lon: -158.0539, description: "The world's most famous tube.", difficulty: "Pro Only", facing: 315 },
            { id: 'teahupoo', name: 'Teahupo\'o, Tahiti', lat: -17.8471, lon: -149.2667, description: "Heaviest wave in the world.", difficulty: "Pro Only", facing: 200 },
            { id: 'jbay', name: 'Jeffrey\'s Bay, SA', lat: -34.0331, lon: 24.9153, description: "Endless right hand point break.", difficulty: "Advanced", facing: 90 },
            { id: 'uluwatu', name: 'Uluwatu, Bali', lat: -8.8149, lon: 115.0884, description: "Iconic Balinese left hander.", difficulty: "Advanced", facing: 270 },
            { id: 'hossegor', name: 'Hossegor, France', lat: 43.6706, lon: -1.4363, description: "Heavy beach break barrels.", difficulty: "Advanced", facing: 270 },
            { id: 'trestles', name: 'Lower Trestles, CA', lat: 33.3829, lon: -117.5932, description: "High performance cobblestone reef.", difficulty: "Intermediate", facing: 225 },
        ];

        // MOCK DATA: Tides are calculated mathematically (no API).
        const MOCK_DATA = { tides: { high: "10:45 AM", low: "04:30 PM", nextHigh: "11:15 PM" } };

        // --- HELPERS ---
        const getStokeRating = (waveHeight, profile) => {
            let score = 5; 
            const { boardSize, skill } = profile;

            // Height Logic (Meters)
            if (boardSize === 'long') {
                if (waveHeight < 0.6) score += 3;
                else if (waveHeight < 1.2) score += 2;
                else if (waveHeight > 2.0) score -= 2;
            } 
            else if (boardSize === 'med') {
                if (waveHeight > 0.8 && waveHeight < 1.8) score += 3;
                if (waveHeight < 0.5) score -= 2;
            }
            else if (boardSize === 'short') {
                if (waveHeight < 0.8) score -= 3;
                if (waveHeight > 1.2) score += 4;
            }

            if (skill === 'kook') {
                if (waveHeight > 1.2) score = 2;
                else if (waveHeight < 0.8) score += 1;
            }
            else if (skill === 'pro') {
                if (waveHeight < 0.8) score -= 2;
                if (waveHeight > 1.5) score += 2;
            }

            score = Math.max(1, Math.min(10, Math.round(score)));
            
            let label = "Average";
            let color = "text-yellow-500";
            let bg = "bg-yellow-50";

            if (score >= 8) { label = "Epic Stoke!"; color = "text-green-600"; bg = "bg-green-50"; }
            else if (score >= 6) { label = "Fun Waves"; color = "text-green-500"; bg = "bg-green-50"; }
            else if (score <= 3) { label = skill === 'kook' && waveHeight > 1.5 ? "Scary Big!" : "Flat/Poor"; color = "text-red-500"; bg = "bg-red-50"; }

            return { score, label, color, bg };
        };

        const getWindQuality = (windDir, location) => {
            if (!location.facing) return { label: 'Unknown', color: 'text-slate-500' };
            
            let diff = Math.abs(windDir - location.facing);
            if (diff > 180) diff = 360 - diff;
            
            // Onshore: Wind direction is similar to beach facing direction (within 60 degrees)
            if (diff < 60) return { label: 'Onshore üí®', color: 'text-red-500' };
            
            // Offshore: Wind direction is opposite to beach facing direction (within 60 degrees of 180 opposite)
            if (diff > 120) return { label: 'Offshore üíé', color: 'text-green-600' };
            
            return { label: 'Cross-shore', color: 'text-yellow-600' };
        };

        const getWeatherEmoji = (code) => {
            if (code === 0) return "‚òÄÔ∏è";
            if (code <= 3) return "‚õÖ";
            if (code <= 48) return "üå´Ô∏è";
            if (code <= 67) return "üåßÔ∏è";
            if (code <= 77) return "‚ùÑÔ∏è";
            if (code <= 82) return "üå¶Ô∏è";
            return "‚õàÔ∏è";
        };

        const getWeatherDescription = (code) => {
            if (code === 0) return "Clear Sky";
            if (code <= 3) return "Partly Cloudy";
            if (code <= 48) return "Foggy";
            if (code <= 67) return "Rainy";
            if (code <= 77) return "Snowy";
            if (code <= 82) return "Showers";
            return "Thunderstorm";
        };

        // NEW: Dynamic Labels based on real data
        const getAirTempLabel = (temp) => {
            if (temp < 5) return "Freezing!";
            if (temp < 15) return "Crisp";
            if (temp < 24) return "Pleasant";
            if (temp < 30) return "Toasty";
            return "Scorching";
        };

        const getWaterTempLabel = (temp) => {
            if (temp === null) return "--";
            if (temp < 14) return "Full Steamer";
            if (temp < 19) return "Spring Suit";
            if (temp < 22) return "Shorty";
            return "Trunks";
        };

        // --- COMPONENTS ---

        function StatCard({ icon: Icon, label, value, subValue, highlight = false, rotation = 0 }) {
            return (
                <div className={`dog-card p-4 flex flex-col items-center justify-center text-center h-36 ${highlight ? 'border-blue-200 bg-blue-50' : ''}`}>
                    <div className="flex items-center justify-center mb-2 text-blue-600">
                        <div style={{ transform: `rotate(${rotation}deg)` }} className="compass-arrow">
                            <Icon className="w-8 h-8" />
                        </div>
                    </div>
                    <span className="text-xs text-slate-500 uppercase tracking-wider font-bold">{label}</span>
                    <span className="text-2xl font-bold mt-1 text-slate-800">{value}</span>
                    {subValue && <span className="text-xs text-slate-500 mt-1 font-medium">{subValue}</span>}
                </div>
            );
        }

        // Updated Wind Card to support quality colors
        function WindStatCard({ icon: Icon, label, value, subValue, qualityColor = 'text-slate-500', rotation = 0 }) {
            return (
                <div className={`dog-card p-4 flex flex-col items-center justify-center text-center h-36`}>
                    <div className="flex items-center justify-center mb-2 text-blue-600">
                        <div style={{ transform: `rotate(${rotation}deg)` }} className="compass-arrow">
                            <Icon className="w-8 h-8" />
                        </div>
                    </div>
                    <span className="text-xs text-slate-500 uppercase tracking-wider font-bold">{label}</span>
                    <span className="text-2xl font-bold mt-1 text-slate-800">{value}</span>
                    {subValue && <span className={`text-xs mt-1 font-bold ${qualityColor}`}>{subValue}</span>}
                </div>
            );
        }

        function SplitStatCard({ label1, value1, subValue1, icon1: Icon1, label2, value2, subValue2, icon2: Icon2 }) {
            return (
                <div className="dog-card flex h-36 relative overflow-hidden">
                    {/* Left Half */}
                    <div className="flex-1 flex flex-col items-center justify-center p-2 bg-blue-50/50 border-r border-slate-100">
                        <div className="text-blue-500 mb-1"><Icon1 className="w-5 h-5"/></div>
                        <span className="text-[10px] text-slate-400 font-bold uppercase tracking-wider">{label1}</span>
                        <span className="text-2xl font-bold text-slate-800">{value1}</span>
                        <span className="text-[10px] text-slate-400">{subValue1}</span>
                    </div>
                    {/* Right Half */}
                    <div className="flex-1 flex flex-col items-center justify-center p-2">
                        <div className="text-cyan-500 mb-1"><Icon2 className="w-5 h-5"/></div>
                        <span className="text-[10px] text-slate-400 font-bold uppercase tracking-wider">{label2}</span>
                        <span className="text-2xl font-bold text-slate-800">{value2}</span>
                        <span className="text-[10px] text-slate-400">{subValue2}</span>
                    </div>
                </div>
            );
        }

        function WeatherCard({ weatherCode }) {
            return (
                <div className="dog-card h-36 flex flex-col items-center justify-center relative overflow-hidden bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-200">
                     <div className="absolute top-0 right-0 p-4 opacity-20"><Icons.Sun className="w-16 h-16"/></div>
                     <div className="text-5xl mb-2 drop-shadow-md">{getWeatherEmoji(weatherCode)}</div>
                     <div className="font-bold text-lg tracking-wide drop-shadow-sm">{getWeatherDescription(weatherCode)}</div>
                     <div className="text-xs opacity-80 uppercase tracking-widest font-semibold mt-1">Current Conditions</div>
                </div>
            );
        }

        function SurfCam({ location }) {
            const query = encodeURIComponent(`${location.name} surf wave ocean`);
            const imageUrl = `https://tse1.mm.bing.net/th?q=${query}&w=1600&h=900&c=7&rs=1&p=0`;
            const [time, setTime] = React.useState(new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }));

            React.useEffect(() => {
                const timer = setInterval(() => setTime(new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })), 1000);
                return () => clearInterval(timer);
            }, []);

            return (
                <div className="dog-card col-span-1 md:col-span-2 lg:col-span-3 h-80 relative group overflow-hidden shadow-xl">
                    <img 
                        src={imageUrl} 
                        alt={`${location.name} Surf Cam`} 
                        className="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-105"
                        onError={(e) => { e.target.src = "https://images.unsplash.com/photo-1502680390469-be75c86b636f?auto=format&fit=crop&w=1600"; }}
                    />
                    {/* Cinematic Letterbox */}
                    <div className="absolute top-0 left-0 right-0 h-12 bg-gradient-to-b from-black/80 to-transparent pointer-events-none"></div>
                    <div className="absolute bottom-0 left-0 right-0 h-24 bg-gradient-to-t from-black/80 to-transparent pointer-events-none"></div>

                    {/* Overlay */}
                    <div className="absolute inset-0 flex flex-col justify-between p-6 pointer-events-none">
                        <div className="flex justify-between items-start">
                            <div className="flex items-center gap-3 bg-red-600/90 text-white px-3 py-1.5 rounded-md text-xs font-bold tracking-widest shadow-lg">
                                <div className="w-2 h-2 rounded-full bg-white animate-pulse"></div>
                                LIVE FEED
                            </div>
                            <div className="text-xs font-mono text-white/90 bg-black/40 backdrop-blur-md px-3 py-1.5 rounded border border-white/10">CAM 01 ‚Ä¢ 4K</div>
                        </div>
                        <div className="flex justify-between items-end">
                             <div className="text-white/60 text-xs font-mono">{location.lat.toFixed(4)}, {location.lon.toFixed(4)}</div>
                             <div className="text-white text-3xl font-bold font-mono tracking-tight drop-shadow-lg">{time}</div>
                        </div>
                    </div>
                    {/* Scanlines */}
                    <div className="absolute inset-0 pointer-events-none opacity-10" style={{background: 'repeating-linear-gradient(0deg, transparent, transparent 2px, #000 3px)'}}></div>
                </div>
            );
        }

        function TideGraph({ hourlyWeather }) {
            const width = 1200; 
            const height = 150;
            const amplitude = 40;
            const baseline = height / 2 + 10;
            const frequency = (Math.PI * 2) / (12 * 60); 
            const highTideMinute = 10 * 60 + 45; 
            const phase = Math.PI / 2 - frequency * highTideMinute;

            let pathD = `M0,${baseline} `;
            const points = [];

            for (let i = 0; i <= 24 * 60; i += 20) {
                const x = (i / (24 * 60)) * width;
                const y = baseline - amplitude * Math.sin(frequency * i + phase);
                pathD += `L${x},${y} `;
                points.push({ x, y, time: i });
            }

            const fillPath = `${pathD} V${height + 50} H0 Z`;
            const now = new Date();
            const currentMin = now.getHours() * 60 + now.getMinutes();
            const nowX = (currentMin / (24 * 60)) * width;

            // Generate Weather Markers every 2 hours
            const weatherMarkers = [];
            if (hourlyWeather && hourlyWeather.length >= 24) {
                for (let h = 0; h < 24; h += 2) {
                    const x = (h * 60 / (24 * 60)) * width;
                    weatherMarkers.push({
                        x,
                        time: `${h}:00`,
                        emoji: getWeatherEmoji(hourlyWeather[h])
                    });
                }
            }

            return (
                <div className="dog-card col-span-1 md:col-span-2 lg:col-span-3 overflow-hidden flex flex-col h-72 relative bg-gradient-to-b from-white to-blue-50/50">
                    <div className="px-5 py-4 border-b border-slate-100 flex justify-between items-center bg-white/80 backdrop-blur-sm z-10">
                        <div className="flex items-center gap-2 text-blue-600">
                            <Icons.Clock className="w-5 h-5" />
                            <h3 className="font-bold uppercase tracking-wider text-sm">24H Tide & Weather Timeline</h3>
                        </div>
                        <div className="flex items-center gap-4 text-xs font-medium text-slate-500">
                            <span className="flex items-center gap-1"><div className="w-2 h-2 rounded-full bg-blue-500"></div> High</span>
                            <span className="flex items-center gap-1"><div className="w-2 h-2 rounded-full border border-blue-500"></div> Low</span>
                        </div>
                    </div>
                    
                    <div className="overflow-x-auto overflow-y-hidden custom-scrollbar flex-1 relative w-full">
                        <div style={{ width: `${width}px`, height: '100%' }} className="relative">
                            
                            {/* Weather Strip at Top */}
                            <div className="absolute top-2 left-0 w-full h-8 z-20 pointer-events-none">
                                {weatherMarkers.map((m, i) => (
                                    <div key={i} className="absolute top-0 flex flex-col items-center transform -translate-x-1/2" style={{ left: `${m.x}px` }}>
                                        <div className="text-xl leading-none shadow-sm filter drop-shadow-sm hover:scale-125 transition-transform cursor-help" title="Forecast">{m.emoji}</div>
                                        <div className="text-[9px] text-slate-400 font-bold mt-1">{m.time}</div>
                                        {/* Vertical Guide Line */}
                                        <div className="w-px h-40 bg-slate-200 mt-1 dashed opacity-50"></div>
                                    </div>
                                ))}
                            </div>

                            <svg width="100%" height="100%" viewBox={`0 0 ${width} ${height}`} preserveAspectRatio="none" className="absolute bottom-0 pt-10">
                                <defs>
                                    <linearGradient id="tideGradient" x1="0" y1="0" x2="0" y2="1">
                                        <stop offset="0%" stopColor="#3B82F6" stopOpacity="0.2" />
                                        <stop offset="100%" stopColor="#3B82F6" stopOpacity="0" />
                                    </linearGradient>
                                </defs>
                                <path d={fillPath} fill="url(#tideGradient)" stroke="none" />
                                <path d={pathD} fill="none" stroke="#3B82F6" strokeWidth="3" strokeLinecap="round" />
                                <line x1={nowX} y1="0" x2={nowX} y2={height} stroke="#EF4444" strokeDasharray="4 4" strokeWidth="2" />
                                <circle cx={nowX} cy={baseline - amplitude * Math.sin(frequency * currentMin + phase)} r="5" fill="#EF4444" stroke="white" strokeWidth="2"/>
                            </svg>
                            
                            <div className="absolute top-12 text-[10px] font-bold text-white bg-red-500 px-2 py-0.5 rounded-full transform -translate-x-1/2 shadow-md z-30" style={{ left: `${nowX}px` }}>NOW</div>
                        </div>
                    </div>
                </div>
            );
        }

        function SearchBox({ onSelectLocation }) {
            const [query, setQuery] = React.useState('');
            const [results, setResults] = React.useState([]);
            const [isSearching, setIsSearching] = React.useState(false);
            const [dropdownOpen, setDropdownOpen] = React.useState(false);

            React.useEffect(() => {
                const timer = setTimeout(() => {
                    if (query.length >= 2) performSearch(query);
                    else { setResults([]); setDropdownOpen(false); }
                }, 500); 
                return () => clearTimeout(timer);
            }, [query]);

            const performSearch = async (term) => {
                setIsSearching(true);
                const localMatches = FAMOUS_SPOTS.filter(spot => spot.name.toLowerCase().includes(term.toLowerCase()));
                try {
                    const res = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${term}&count=5&language=en&format=json`);
                    const data = await res.json();
                    const apiMatches = (data.results || []).map(item => ({
                        id: `geo_${item.id}`,
                        name: `${item.name}, ${item.country_code?.toUpperCase() || ''}`,
                        lat: item.latitude,
                        lon: item.longitude,
                        description: "Location found via Global Search",
                        difficulty: "Unknown"
                    }));
                    setResults([...localMatches, ...apiMatches]);
                    setDropdownOpen(true);
                } catch (e) { setResults(localMatches); setDropdownOpen(true); } 
                finally { setIsSearching(false); }
            };

            const handleSelect = (loc) => { onSelectLocation(loc); setQuery(''); setDropdownOpen(false); };

            return (
                <div className="relative mb-6 z-50">
                    <div className="relative group">
                        <input 
                            type="text" 
                            className="dog-input w-full pl-10 pr-4 py-3 rounded-xl text-sm font-medium shadow-sm"
                            placeholder="Find a beach..."
                            value={query}
                            onChange={(e) => setQuery(e.target.value)}
                        />
                        <div className="absolute left-3 top-3.5 text-slate-400">
                            {isSearching ? <div className="spinner w-4 h-4 border-2"></div> : <Icons.Search className="w-5 h-5" />}
                        </div>
                        {query && (
                            <button onClick={() => setQuery('')} className="absolute right-3 top-3.5 text-slate-400 hover:text-red-500">
                                <Icons.X className="w-4 h-4" />
                            </button>
                        )}
                    </div>
                    {dropdownOpen && results.length > 0 && (
                        <div className="absolute top-full left-0 right-0 mt-2 bg-white border border-slate-200 rounded-xl overflow-hidden shadow-xl z-50 max-h-60 overflow-y-auto custom-scrollbar">
                            {results.map((loc) => (
                                <button key={loc.id} onClick={() => handleSelect(loc)} className="w-full text-left px-4 py-3 hover:bg-blue-50 border-b border-slate-50 last:border-0 flex items-center justify-between group transition-colors">
                                    <div>
                                        <div className="font-bold text-sm text-slate-700 group-hover:text-blue-600">{loc.name}</div>
                                        <div className="text-xs text-slate-400">{loc.lat.toFixed(2)}, {loc.lon.toFixed(2)}</div>
                                    </div>
                                    {loc.id.startsWith('geo_') && <Icons.MapPin className="w-3 h-3 text-slate-300" />}
                                </button>
                            ))}
                        </div>
                    )}
                </div>
            );
        }

        // New ModeCard Component used in Sidebar
        function ModeCard({ profile, onClick }) {
            return (
                <button onClick={onClick} className="w-full relative group">
                    <div className="p-4 bg-slate-50 border border-slate-200 rounded-2xl hover:bg-blue-50 hover:border-blue-200 transition-all flex items-center gap-3 text-left">
                        <div className="p-2 bg-white border border-slate-200 rounded-xl shadow-sm group-hover:border-blue-300 transition-colors text-blue-500">
                            <Icons.Board className="w-5 h-5"/>
                        </div>
                        <div>
                            <div className="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-0.5">Current Setup</div>
                            <div className="font-bold text-slate-700 text-sm">
                                {profile.boardSize === 'short' ? 'Shortie' : profile.boardSize === 'med' ? 'Middie' : 'Longboard'} 
                                <span className="text-slate-400 font-normal"> ‚Ä¢ </span>
                                {profile.skill === 'kook' ? 'Doggy Paddler' : profile.skill === 'intermediate' ? 'Wave Chaser' : 'Big Dog'}
                            </div>
                        </div>
                        <div className="ml-auto text-slate-300 group-hover:text-blue-400">
                            <Icons.Gear className="w-4 h-4"/>
                        </div>
                    </div>
                </button>
            );
        }

        function SettingsView({ profile, onSave, onCancel }) {
            const [localProfile, setLocalProfile] = React.useState(profile);

            return (
                <div className="h-full flex flex-col">
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-2xl font-extrabold text-slate-800">Your Setup</h2>
                        <button onClick={onCancel} className="p-2 text-slate-400 hover:text-slate-600"><Icons.X className="w-6 h-6"/></button>
                    </div>

                    <div className="space-y-8 flex-1 overflow-y-auto px-1">
                        
                        {/* Board Type Toggle */}
                        <div>
                            <h3 className="font-bold text-slate-400 uppercase tracking-wider text-xs mb-3">Your Quiver</h3>
                            <div className="toggle-group">
                                {['soft', 'hard'].map(type => (
                                    <div 
                                        key={type}
                                        onClick={() => setLocalProfile({...localProfile, boardType: type})}
                                        className={`toggle-option ${localProfile.boardType === type ? 'selected' : ''}`}
                                    >
                                        <div className="text-current mb-2">
                                            {type === 'soft' ? <Icons.LifeBuoy className="w-8 h-8"/> : <Icons.Rocket className="w-8 h-8"/>}
                                        </div>
                                        <div className="font-bold text-sm">{type === 'soft' ? 'Foamie' : 'Fiberglass'}</div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* Length Toggle */}
                        <div>
                            <h3 className="font-bold text-slate-400 uppercase tracking-wider text-xs mb-3">Length</h3>
                            <div className="toggle-group">
                                {[
                                    { id: 'short', name: 'Shortie', Icon: Icons.Lightning, label: 'Short' },
                                    { id: 'med', name: 'Middie', Icon: Icons.Target, label: 'Mid' },
                                    { id: 'long', name: 'Longboard', Icon: Icons.Tree, label: 'Long' }
                                ].map(size => (
                                    <div 
                                        key={size.id}
                                        onClick={() => setLocalProfile({...localProfile, boardSize: size.id})}
                                        className={`toggle-option ${localProfile.boardSize === size.id ? 'selected' : ''}`}
                                    >
                                        <div className="text-current mb-1"><size.Icon className="w-6 h-6"/></div>
                                        <div className="font-bold text-sm">{size.name}</div>
                                        <div className="text-[10px] opacity-70">{size.label}</div>
                                    </div>
                                ))}
                            </div>
                            <div className="mt-2 text-xs text-center text-slate-400 italic">
                                {localProfile.boardSize === 'short' && "Needs power. High rating for pumping waves, terrible for mush."}
                                {localProfile.boardSize === 'med' && "Jack of all trades. Good paddle power, handles most conditions well."}
                                {localProfile.boardSize === 'long' && "You'll catch pretty much everything. High rating for small waves."}
                            </div>
                        </div>

                        {/* Skill Level Toggle */}
                        <div>
                            <h3 className="font-bold text-slate-400 uppercase tracking-wider text-xs mb-3">Skill Level</h3>
                            <div className="toggle-group">
                                {[
                                    {id: 'kook', name: 'Paddler', Icon: Icons.Paw, label: 'Beginner'},
                                    {id: 'intermediate', name: 'Chaser', Icon: Icons.Fin, label: 'Intermed'},
                                    {id: 'pro', name: 'Big Dog', Icon: Icons.Crown, label: 'Pro'}
                                ].map(level => (
                                    <div 
                                        key={level.id}
                                        onClick={() => setLocalProfile({...localProfile, skill: level.id})}
                                        className={`toggle-option ${localProfile.skill === level.id ? 'selected' : ''}`}
                                    >
                                        <div className="text-current mb-1"><level.Icon className="w-6 h-6"/></div>
                                        <div className="font-bold text-sm">{level.name}</div>
                                        <div className="text-[10px] opacity-70">{level.label}</div>
                                    </div>
                                ))}
                            </div>
                             <div className="mt-2 text-xs text-center text-slate-400 italic">
                                {localProfile.skill === 'kook' && "I like small, friendly waves. Big stuff scares me."}
                                {localProfile.skill === 'intermediate' && "I can catch green waves and turn a bit."}
                                {localProfile.skill === 'pro' && "Barrels, airs, and heavy water. Bring it on."}
                            </div>
                        </div>
                    </div>

                    <div className="mt-6 pt-6 border-t border-slate-100">
                        <button 
                            onClick={() => onSave(localProfile)}
                            className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-blue-200 transition-all active:scale-95"
                        >
                            Save Profile
                        </button>
                    </div>
                </div>
            );
        }

        function App() {
            const [view, setView] = React.useState('dashboard'); 
            const [favorites, setFavorites] = React.useState(() => {
                try { const saved = localStorage.getItem('surfdogFavs'); return saved ? JSON.parse(saved) : LOCAL_SPOTS; } 
                catch (e) { return LOCAL_SPOTS; }
            });

            const [profile, setProfile] = React.useState(() => {
                try { 
                    const saved = localStorage.getItem('surfdogProfile'); 
                    return saved ? JSON.parse(saved) : { boardType: 'soft', boardSize: 'long', skill: 'kook' }; 
                } catch(e) { return { boardType: 'soft', boardSize: 'long', skill: 'kook' }; }
            });

            React.useEffect(() => { localStorage.setItem('surfdogFavs', JSON.stringify(favorites)); }, [favorites]);
            React.useEffect(() => { localStorage.setItem('surfdogProfile', JSON.stringify(profile)); }, [profile]);

            const [activeLocation, setActiveLocation] = React.useState(favorites[0] || LOCAL_SPOTS[0]);
            const [data, setData] = React.useState(null);
            const [loading, setLoading] = React.useState(true);
            const [error, setError] = React.useState(null);

            React.useEffect(() => {
                async function fetchSurfData() {
                    setLoading(true); setError(null);
                    try {
                        const { lat, lon } = activeLocation;
                        const marineRes = await fetch(`https://marine-api.open-meteo.com/v1/marine?latitude=${lat}&longitude=${lon}&current=wave_height,wave_period,wave_direction&hourly=sea_surface_temperature&timezone=auto`);
                        const marineJson = await marineRes.json();
                        const weatherRes = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,wind_speed_10m,wind_direction_10m,weather_code&hourly=weather_code&timezone=auto`);
                        const weatherJson = await weatherRes.json();
                        if (!marineJson.current || !weatherJson.current) throw new Error("Incomplete data");

                        const currentHour = new Date().getHours();
                        const currentWaterTemp = marineJson.hourly?.sea_surface_temperature ? marineJson.hourly.sea_surface_temperature[currentHour] : null; 

                        setData({
                            waveHeight: marineJson.current.wave_height,
                            wavePeriod: marineJson.current.wave_period,
                            waveDir: marineJson.current.wave_direction,
                            temp: weatherJson.current.temperature_2m,
                            windSpeed: weatherJson.current.wind_speed_10m,
                            windDir: weatherJson.current.wind_direction_10m,
                            weatherCode: weatherJson.current.weather_code,
                            waterTemp: currentWaterTemp,
                            hourlyWeather: weatherJson.hourly.weather_code 
                        });
                    } catch (err) { setError("Could not fetch data."); } 
                    finally { setLoading(false); }
                }
                fetchSurfData();
            }, [activeLocation]);

            const toggleFavorite = (loc) => {
                const isFav = favorites.some(f => f.id === loc.id);
                setFavorites(prev => isFav ? prev.filter(f => f.id !== loc.id) : [...prev, loc]);
            };

            const getCompassDir = (deg) => ['N','NE','E','SE','S','SW','W','NW'][Math.round(deg / 45) % 8];
            const isCurrentFavorite = favorites.some(f => f.id === activeLocation.id);

            const rating = data ? getStokeRating(data.waveHeight, profile) : { score: '-', label: 'Loading', color: 'text-slate-400', bg: 'bg-slate-50' };
            const windStatus = data ? getWindQuality(data.windDir, activeLocation) : { label: 'Unknown', color: '' };

            return (
                <div className="flex justify-center p-0 md:p-8 watercolor-bg min-h-screen md:h-screen md:overflow-hidden">
                    <div className="w-full max-w-7xl md:rounded-[32px] overflow-hidden flex flex-col md:flex-row h-full md:h-[calc(100vh-4rem)] shadow-2xl border-0 md:border border-slate-200 bg-white/50 backdrop-blur-sm">
                        
                        {/* Sidebar (Full Height on Desktop, Normal flow on Mobile) */}
                        <div className="w-full md:w-80 bg-white border-b md:border-b-0 md:border-r border-slate-100 flex flex-col relative z-20 shrink-0 h-auto md:h-full">
                            <div className="absolute top-0 left-0 right-0 h-2 bg-gradient-to-r from-blue-400 via-blue-500 to-cyan-400"></div>
                            
                            <div className="p-6 relative flex-none">
                                <div className="flex items-center justify-between mb-6 md:mb-8">
                                    <div className="flex items-center gap-3">
                                        <Icons.Logo />
                                        <div className="flex flex-col">
                                            <h1 className="text-2xl font-extrabold tracking-tight text-slate-800 leading-none">SURF<span className="text-blue-600">DOG</span></h1>
                                            <span className="text-[10px] font-bold tracking-widest text-slate-400 uppercase">The Loyal Report</span>
                                        </div>
                                    </div>
                                    <button onClick={() => setView('settings')} className="p-2 text-slate-400 hover:text-blue-500 hover:bg-blue-50 rounded-full transition-all md:hidden">
                                        <Icons.Gear className="w-5 h-5" />
                                    </button>
                                </div>

                                {/* Mode Card (Mobile Only Position) */}
                                <div className="block md:hidden mb-6">
                                    <ModeCard profile={profile} onClick={() => setView('settings')} />
                                </div>

                                <SearchBox onSelectLocation={setActiveLocation} />
                            </div>

                            {/* Favorites List */}
                            <div className="flex-1 overflow-y-auto custom-scrollbar px-6 pb-2 min-h-[150px] md:min-h-0">
                                <div className="px-2 pb-2 text-xs font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2">
                                    <Icons.Star className="w-3 h-3 text-slate-300" fill="currentColor"/> Favorites
                                </div>
                                <div className="space-y-2">
                                    {favorites.length === 0 && <div className="text-sm text-slate-400 p-4 text-center italic bg-slate-50 rounded-lg border border-slate-100 border-dashed">No favorites yet. Fetch one! ü¶¥</div>}
                                    {favorites.map(loc => (
                                        <button key={loc.id} onClick={() => { setActiveLocation(loc); setView('dashboard'); }} className={`dog-btn w-full text-left px-4 py-3 rounded-xl flex items-center justify-between group ${activeLocation.id === loc.id ? 'active' : ''}`}>
                                            <span className="font-semibold text-sm truncate">{loc.name}</span>
                                            {activeLocation.id === loc.id && <div className="w-2 h-2 rounded-full bg-white shadow-sm"></div>}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {/* Mode Card (Desktop Only Position - Bottom Left) */}
                            <div className="hidden md:block p-6 mt-auto border-t border-slate-100">
                                <ModeCard profile={profile} onClick={() => setView('settings')} />
                            </div>
                        </div>

                        {/* Main Content Area (Scrolls independently on desktop) */}
                        <div className="flex-1 p-4 md:p-10 relative overflow-y-auto custom-scrollbar bg-slate-50/50 h-full">
                            
                            {view === 'settings' ? (
                                <SettingsView 
                                    profile={profile} 
                                    onSave={(newProfile) => { setProfile(newProfile); setView('dashboard'); }}
                                    onCancel={() => setView('dashboard')}
                                />
                            ) : (
                                <>
                                    {/* Header */}
                                    <div className="flex flex-col md:flex-row justify-between items-start md:items-start mb-8 gap-4 border-b border-slate-200 pb-6">
                                        <div>
                                            <div className="flex items-center gap-3 mb-1">
                                                <h2 className="text-3xl md:text-4xl font-extrabold text-slate-800 tracking-tight">{activeLocation.name}</h2>
                                                <button onClick={() => toggleFavorite(activeLocation)} className="p-2 rounded-full hover:bg-yellow-50 transition-colors group">
                                                    <Icons.Star className={`w-6 h-6 transition-colors ${isCurrentFavorite ? "text-yellow-400" : "text-slate-300 group-hover:text-yellow-400"}`} fill={isCurrentFavorite ? "currentColor" : "none"} />
                                                </button>
                                            </div>
                                            <p className="text-slate-500 font-medium flex items-center gap-2">
                                                {activeLocation.lat.toFixed(2)}, {activeLocation.lon.toFixed(2)}
                                                <span className="px-3 py-1 rounded-full bg-blue-100 text-blue-700 text-xs font-bold uppercase tracking-wide">
                                                    {activeLocation.difficulty}
                                                </span>
                                            </p>
                                        </div>

                                        {/* Stoke Rating Card */}
                                        <div className={`p-4 rounded-2xl border-2 ${rating.bg} border-opacity-50 w-full md:w-auto md:min-w-[180px] text-center shadow-sm`}>
                                            <div className="text-xs font-bold uppercase tracking-wider text-slate-500 mb-1">Stoke Rating</div>
                                            <div className={`text-4xl font-extrabold ${rating.color}`}>{rating.score}<span className="text-xl text-slate-400">/10</span></div>
                                            <div className={`text-sm font-bold ${rating.color} mt-1`}>{rating.label}</div>
                                        </div>
                                    </div>

                                    {/* Grid */}
                                    {loading ? (
                                        <div className="h-96 flex flex-col items-center justify-center gap-4">
                                            <div className="spinner w-8 h-8"></div>
                                            <p className="text-slate-400 font-medium animate-pulse">Sniffing out the waves...</p>
                                        </div>
                                    ) : error ? (
                                        <div className="p-8 bg-red-50 border border-red-100 rounded-2xl text-center text-red-600 font-medium">{error}</div>
                                    ) : data && (
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pb-20 md:pb-0">
                                            
                                            {/* Key Stats (Wave Height, Swell Dir, Wind) */}
                                            <StatCard icon={Icons.Waves} label="Wave Height" value={`${data.waveHeight}m`} subValue={`${data.wavePeriod}s Period`} highlight={true} />
                                            <StatCard icon={Icons.Navigation} label="Swell Dir" value={getCompassDir(data.waveDir)} subValue={`${data.waveDir}¬∞`} rotation={data.waveDir} />
                                            <WindStatCard 
                                                icon={Icons.Wind} 
                                                label="Wind" 
                                                value={`${Math.round(data.windSpeed)}kph`} 
                                                subValue={windStatus.label} 
                                                qualityColor={windStatus.color}
                                                rotation={data.windDir} 
                                            />
                                            
                                            {/* Weather & Temp Split */}
                                            <WeatherCard weatherCode={data.weatherCode} />
                                            <SplitStatCard 
                                                label1="Air Temp" value1={`${Math.round(data.temp)}¬∞`} subValue1={getAirTempLabel(data.temp)} icon1={Icons.Thermometer}
                                                label2="Water" value2={data.waterTemp !== null ? `${data.waterTemp}¬∞` : "No Data"} subValue2={getWaterTempLabel(data.waterTemp)} icon2={Icons.Droplets}
                                            />
                                            
                                            {/* Local Knowledge */}
                                            <div className="dog-card p-6 flex flex-col justify-center relative overflow-hidden h-36">
                                                <div className="watercolor-stripe absolute top-0 right-0 w-32 h-full pointer-events-none opacity-20 transform skew-x-12"></div>
                                                <h3 className="font-bold uppercase tracking-wider text-sm text-blue-600 mb-1">Local Knowledge</h3>
                                                <p className="text-slate-600 leading-snug text-sm font-medium line-clamp-2">
                                                    {activeLocation.description}
                                                </p>
                                                <div className="mt-2 flex items-center gap-2">
                                                    <span className="px-1.5 py-0.5 bg-slate-100 rounded text-[10px] font-bold text-slate-500">Safe Swim</span>
                                                </div>
                                            </div>

                                            {/* Full Width Camera */}
                                            <SurfCam location={activeLocation} />

                                            {/* Full Width Tide Graph */}
                                            <TideGraph hourlyWeather={data.hourlyWeather} />
                                        </div>
                                    )}
                                </>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>
</body>
</html>
